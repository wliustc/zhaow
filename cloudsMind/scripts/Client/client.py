#!/user/bin/env python
#coding=utf-8
import httplib

import datetime
import random
import time
import threading

import struct

class url_request():
    times = [int(1)]
    error = []
    result=[]
    def testProtocol(self):
        #参数初始化
        serverIp = '192.168.0.241'
        portNumber = ''
        requestAddress = 'http://192.168.0.241/parser/androidapp'
        #客户端激活
        # content = '<?xml version=\'1.0\' encoding=\'UTF-8\' ?><Request><OperID><TenantID>ngem</TenantID><ClientUID/><FlowNum/><Timezone>-1</Timezone><Result>-1</Result></OperID><ClientIDInfo><UserName>'+'test'+str(random.randint(100, 10000))+'</UserName><UserPassword>AvRYxoIg80o=</UserPassword></ClientIDInfo><MobileIDInfo><ClientOSType>1</ClientOSType><ClientOS>Android</ClientOS><ModelType>1</ModelType><Model>8692-M02</Model><OSVersion>5.1.1</OSVersion><Jailed>0</Jailed><Imei>8685020123293397</Imei><WifiMac>74:ac:5f:22:9e:82</WifiMac><Imsi/><SN>c892948</SN><ClientIP>192.168.0.189</ClientIP><SpecialTypeFlag>0</SpecialTypeFlag></MobileIDInfo></Request>'
        #推送应用
        content = '<?xml version=\'1.0\' encoding=\'UTF-8\' ?><Request><OperID><TenantID>ngem</TenantID><ClientUID>9042f6b09c7642f13cca5c</ClientUID><FlowNum>eece95c6-8627-4014-bed0-ebea60e2bd0c</FlowNum><Timezone>-1</Timezone><Result>-1</Result></OperID><AppList TotalCount="121"><App><PackageName>com.yulong.android.factorypattern</PackageName><Name>工厂模式</Name><VersionName>1.01.004_VER_2015.09.18_10:52:17</VersionName><VersionCode>101004</VersionCode><Type>1</Type><Size>1974272</Size><Status>1</Status></App><App><PackageName>com.android.providers.telephony</PackageName><Name>电话/信息存储</Name><VersionName>_VER_2015.12.01_15:24:43</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>1486848</Size><Status>1</Status></App><App><PackageName>com.android.providers.calendar</PackageName><Name>日历存储</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>1232896</Size><Status>1</Status></App><App><PackageName>com.android.providers.media</PackageName><Name>媒体存储</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>800</VersionCode><Type>1</Type><Size>2322432</Size><Status>1</Status></App><App><PackageName>com.qihoo.kustore</PackageName><Name>应用商店</Name><VersionName>5.3.1.0117</VersionName><VersionCode>503010117</VersionCode><Type>1</Type><Size>20246528</Size><Status>1</Status></App><App><PackageName>com.qti.service.colorservice</PackageName><Name>com.qti.service.colorservice</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>61440</Size><Status>1</Status></App><App><PackageName>com.android.screenrecord</PackageName><Name>录屏服务</Name><VersionName>1.0_VER_2015.11.19_10:12:33</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>708608</Size><Status>1</Status></App><App><PackageName>com.yulong.logredirect</PackageName><Name>离线日志</Name><VersionName>5.23_140325_05_VER_2015.10.19_19:32:02</VersionName><VersionCode>774424953</VersionCode><Type>1</Type><Size>1175552</Size><Status>1</Status></App><App><PackageName>com.xinshuru.inputmethod</PackageName><Name>手心输入法</Name><VersionName>1.8.0.666</VersionName><VersionCode>666</VersionCode><Type>1</Type><Size>42614784</Size><Status>1</Status></App><App><PackageName>com.qualcomm.qti.modemtestmode</PackageName><Name>MBN 测试</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>253952</Size><Status>1</Status></App><App><PackageName>com.android.wallpapercropper</PackageName><Name>com.android.wallpapercropper</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>999424</Size><Status>1</Status></App><App><PackageName>com.yulong.android.ota</PackageName><Name>系统更新</Name><VersionName>V2.01.35112411_VER_2015.11.24_11:10:18</VersionName><VersionCode>2035112411</VersionCode><Type>1</Type><Size>7000064</Size><Status>1</Status></App><App><PackageName>com.android.yulong.facerecognize</PackageName><Name>com.android.yulong.facerecognize</Name><VersionName>1.0_VER_2015.11.28_19:58:01</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>1335296</Size><Status>1</Status></App><App><PackageName>com.yulong.android.compass</PackageName><Name>指南针</Name><VersionName>1.0_VER_2015.10.13_10:41:32</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>102400</Size><Status>1</Status></App><App><PackageName>com.yulong.android.register</PackageName><Name>CP_RgService</Name><VersionName>3.1_VER_2015.10.14_10:41:05</VersionName><VersionCode>3</VersionCode><Type>1</Type><Size>610304</Size><Status>1</Status></App><App><PackageName>com.android.documentsui</PackageName><Name>文档</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>1650688</Size><Status>1</Status></App><App><PackageName>com.android.externalstorage</PackageName><Name>外部存储设备</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>81920</Size><Status>1</Status></App><App><PackageName>com.android.htmlviewer</PackageName><Name>HTML 查看程序</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>20480</Size><Status>1</Status></App><App><PackageName>com.android.mms.service</PackageName><Name>MmsService</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>221184</Size><Status>1</Status></App><App><PackageName>com.yulong.android.coolsafe</PackageName><Name>安全服务</Name><VersionName>1.0.9_VER_2015.12.01_20:32:35</VersionName><VersionCode>20</VersionCode><Type>1</Type><Size>10334208</Size><Status>1</Status></App><App><PackageName>com.yulong.android.coolshop</PackageName><Name>奇酷商城</Name><VersionName>1.4.2_VER_2015.11.21_11:00:31</VersionName><VersionCode>20</VersionCode><Type>1</Type><Size>6438912</Size><Status>1</Status></App><App><PackageName>com.yulong.android.coolshow</PackageName><Name>主题</Name><VersionName>44_VER_2015.12.03_14:37:44</VersionName><VersionCode>44</VersionCode><Type>1</Type><Size>12656640</Size><Status>1</Status></App><App><PackageName>com.android.providers.downloads</PackageName><Name>下载管理程序</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>864256</Size><Status>1</Status></App><App><PackageName>com.qihoo.browser</PackageName><Name>浏览器</Name><VersionName>100.0.6</VersionName><VersionCode>10006</VersionCode><Type>1</Type><Size>29061120</Size><Status>1</Status></App><App><PackageName>com.android.qikupay.apk</PackageName><Name>奇酷支付</Name><VersionName>2.3.2</VersionName><VersionCode>1032</VersionCode><Type>1</Type><Size>311296</Size><Status>1</Status></App><App><PackageName>com.yulong.android.agpssettings</PackageName><Name>增强型GPS设置</Name><VersionName>1.0_VER_2015.10.12_17:28:59</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>221184</Size><Status>1</Status></App><App><PackageName>com.meitu.mtxx_beauty</PackageName><Name>美图秀秀人像美容</Name><VersionName>1.0.0</VersionName><VersionCode>100</VersionCode><Type>1</Type><Size>15060992</Size><Status>1</Status></App><App><PackageName>com.yulong.vendetta</PackageName><Name>com.yulong.vendetta</Name><VersionName>1.0_VER_2015.08.10_17:53:49</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>176128</Size><Status>1</Status></App><App><PackageName>com.yulong.android.xtime</PackageName><Name>闹钟时间</Name><VersionName>3.0_VER_2015.11.24_14:00:12</VersionName><VersionCode>3</VersionCode><Type>1</Type><Size>9633792</Size><Status>1</Status></App><App><PackageName>com.yulong.android.calendar</PackageName><Name>日历</Name><VersionName>1.01.001.20141219_VER_2015.11.05_14:09:22</VersionName><VersionCode>4</VersionCode><Type>1</Type><Size>20197376</Size><Status>1</Status></App><App><PackageName>com.yulong.audioelectric</PackageName><Name>CP_AudioElectric</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>94208</Size><Status>1</Status></App><App><PackageName>com.android.defcontainer</PackageName><Name>软件包权限帮助程序</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>73728</Size><Status>1</Status></App><App><PackageName>com.android.providers.downloads.ui</PackageName><Name>下载</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>40960</Size><Status>1</Status></App><App><PackageName>com.android.pacprocessor</PackageName><Name>PacProcessor</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>45056</Size><Status>1</Status></App><App><PackageName>com.android.certinstaller</PackageName><Name>证书安装程序</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>159744</Size><Status>1</Status></App><App><PackageName>org.codeaurora.bluetooth</PackageName><Name>org.codeaurora.bluetooth</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>684032</Size><Status>1</Status></App><App><PackageName>android</PackageName><Name>Android系统</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>29822976</Size><Status>1</Status></App><App><PackageName>com.qualcomm.wfd.service</PackageName><Name>Wfd Service</Name><VersionName>2.0</VersionName><VersionCode>2</VersionCode><Type>1</Type><Size>237568</Size><Status>1</Status></App><App><PackageName>com.netease.mobimail.coolpad</PackageName><Name>电子邮件</Name><VersionName>1.0.1</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>32153600</Size><Status>1</Status></App><App><PackageName>com.android.mms</PackageName><Name>信息</Name><VersionName>2.05.003_20150202_VER_2015.12.03_15:42:51</VersionName><VersionCode>205005</VersionCode><Type>1</Type><Size>59445248</Size><Status>1</Status></App><App><PackageName>com.android.stk</PackageName><Name>SIM 卡工具包</Name><VersionName>_VER_2015.11.05_19:26:23</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>212992</Size><Status>1</Status></App><App><PackageName>com.yulong.android</PackageName><Name>CP_Common</Name><VersionName>6.0.1.1_VER_2015.05.12_18:17:05</VersionName><VersionCode>3</VersionCode><Type>1</Type><Size>1318912</Size><Status>1</Status></App><App><PackageName>com.android.backupconfirm</PackageName><Name>com.android.backupconfirm</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>32768</Size><Status>1</Status></App><App><PackageName>com.qihoo360.transfer</PackageName><Name>360换机</Name><VersionName>2.10.12.1</VersionName><VersionCode>17</VersionCode><Type>1</Type><Size>18079744</Size><Status>1</Status></App><App><PackageName>com.yulong.android.filebrowser</PackageName><Name>文件管理</Name><VersionName>4.2.14.17_VER_2015.11.27_11:01:01</VersionName><VersionCode>30</VersionCode><Type>1</Type><Size>17231872</Size><Status>1</Status></App><App><PackageName>com.qualcomm.qcrilmsgtunnel</PackageName><Name>com.qualcomm.qcrilmsgtunnel</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>122880</Size><Status>1</Status></App><App><PackageName>com.android.providers.settings</PackageName><Name>设置存储</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>425984</Size><Status>1</Status></App><App><PackageName>com.qiku.riskinsight.launcher3</PackageName><Name>支付域启动器</Name><VersionName>22.0_VER_2015.11.23_22:06:48</VersionName><VersionCode>14</VersionCode><Type>1</Type><Size>8265728</Size><Status>1</Status></App><App><PackageName>com.android.sharedstoragebackup</PackageName><Name>com.android.sharedstoragebackup</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>32768</Size><Status>1</Status></App><App><PackageName>com.yulong.android.wifihelper</PackageName><Name>WlanCertHelper</Name><VersionName>1.01.001_VER_2015.07.06_14:32:12</VersionName><VersionCode>101001</VersionCode><Type>1</Type><Size>77824</Size><Status>1</Status></App><App><PackageName>com.android.printspooler</PackageName><Name>打印处理服务</Name><VersionName>1</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>1945600</Size><Status>1</Status></App><App><PackageName>com.android.dreams.basic</PackageName><Name>基本互动屏保</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>49152</Size><Status>1</Status></App><App><PackageName>com.qihoo360.mobilesafe</PackageName><Name>安全中心</Name><VersionName>6.3.1</VersionName><VersionCode>240</VersionCode><Type>1</Type><Size>32849920</Size><Status>1</Status></App><App><PackageName>com.android.webview</PackageName><Name>Android System WebView</Name><VersionName>39 (5.1.094.P2.151208.8692-arm64)</VersionName><VersionCode>300002</VersionCode><Type>1</Type><Size>1818624</Size><Status>1</Status></App><App><PackageName>com.android.inputdevices</PackageName><Name>输入设备</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>16384</Size><Status>1</Status></App><App><PackageName>com.yulong.android.bugreport.client</PackageName><Name>日志服务</Name><VersionName>3.6.1_VER_2015.12.01_17:07:17</VersionName><VersionCode>20150922</VersionCode><Type>1</Type><Size>9478144</Size><Status>1</Status></App><App><PackageName>com.qihoo360.commodity_barcode.qikoo</PackageName><Name>码上买(奇酷专版)</Name><VersionName>1.0.5.2</VersionName><VersionCode>31</VersionCode><Type>1</Type><Size>6402048</Size><Status>1</Status></App><App><PackageName>com.yulong.android.memo</PackageName><Name>记事本</Name><VersionName>3.01.999.20140912_VER_2015.11.26_19:49:29</VersionName><VersionCode>20140912</VersionCode><Type>1</Type><Size>22118400</Size><Status>1</Status></App><App><PackageName>com.yulong.android.launcher3</PackageName><Name>启动器</Name><VersionName>22.0_VER_2015.12.01_17:14:55</VersionName><VersionCode>21</VersionCode><Type>1</Type><Size>7192576</Size><Status>1</Status></App><App><PackageName>com.alipay.security.mobile.authenticator</PackageName><Name>支付宝安全校验服务</Name><VersionName>3.0</VersionName><VersionCode>6</VersionCode><Type>1</Type><Size>2555904</Size><Status>1</Status></App><App><PackageName>com.icoolme.android.weather</PackageName><Name>最美天气</Name><VersionName>3.04.001.20151120</VersionName><VersionCode>2015112000</VersionCode><Type>1</Type><Size>24621056</Size><Status>1</Status></App><App><PackageName>com.android.cellbroadcastreceiver</PackageName><Name>小区广播</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>258048</Size><Status>1</Status></App><App><PackageName>com.qiku.android.cloudsync</PackageName><Name>奇酷云服务</Name><VersionName>1.01.126.151201</VersionName><VersionCode>101126</VersionCode><Type>1</Type><Size>24715264</Size><Status>1</Status></App><App><PackageName>com.qiku.android.privacyspace</PackageName><Name>隐私空间</Name><VersionName>1.01.001_VER_2015.12.03_11:05:22</VersionName><VersionCode>101001</VersionCode><Type>1</Type><Size>7823360</Size><Status>1</Status></App><App><PackageName>com.android.server.telecom</PackageName><Name>电话</Name><VersionName>_VER_2015.12.03_00:12:23</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>9170944</Size><Status>1</Status></App><App><PackageName>com.android.keychain</PackageName><Name>密钥链</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>143360</Size><Status>1</Status></App><App><PackageName>com.android.camera</PackageName><Name>相机</Name><VersionName>3.01.010_VER_2015.12.01_13:58:27</VersionName><VersionCode>40002</VersionCode><Type>1</Type><Size>18903040</Size><Status>1</Status></App><App><PackageName>com.android.yulong.gmsupdate</PackageName><Name>Gms自动更新</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>106496</Size><Status>1</Status></App><App><PackageName>com.android.dialer</PackageName><Name>电话</Name><VersionName>_VER_2015.12.01_11:21:58</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>12451840</Size><Status>1</Status></App><App><PackageName>com.android.gallery3d</PackageName><Name>照片</Name><VersionName>1.1.1512010</VersionName><VersionCode>40003</VersionCode><Type>1</Type><Size>18161664</Size><Status>1</Status></App><App><PackageName>com.android.packageinstaller</PackageName><Name>软件包安装程序</Name><VersionName>_VER_2015.12.01_16:35:54</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>1404928</Size><Status>1</Status></App><App><PackageName>com.svox.pico</PackageName><Name>Pico TTS</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>77824</Size><Status>1</Status></App><App><PackageName>com.dsi.ant.server</PackageName><Name>ANT HAL Service</Name><VersionName>4.0.0</VersionName><VersionCode>30200</VersionCode><Type>1</Type><Size>65536</Size><Status>1</Status></App><App><PackageName>com.android.proxyhandler</PackageName><Name>ProxyHandler</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>36864</Size><Status>1</Status></App><App><PackageName>com.yulong.android.settings</PackageName><Name>智能控制</Name><VersionName>1.0_VER_2015.11.26_14:04:14</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>3502080</Size><Status>1</Status></App><App><PackageName>com.cloudminds.mam</PackageName><Name>MCP</Name><VersionName>V1.10</VersionName><VersionCode>30000100</VersionCode><Type>0</Type><Size>19169280</Size><Status>1</Status></App><App><PackageName>com.yulong.TestSetting</PackageName><Name>入网现网测试</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>425984</Size><Status>1</Status></App><App><PackageName>com.yulong.android.mwstarter</PackageName><Name>MWStarter</Name><VersionName>1.0_VER_2015.07.20_10:19:13</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>192512</Size><Status>1</Status></App><App><PackageName>com.qiku.riskinsight</PackageName><Name>财产隔离系统</Name><VersionName>1.0_VER_2015.12.01_12:11:21</VersionName><VersionCode>2</VersionCode><Type>1</Type><Size>13320192</Size><Status>1</Status></App><App><PackageName>com.android.managedprovisioning</PackageName><Name>设备配置器</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>978944</Size><Status>1</Status></App><App><PackageName>authentication.information</PackageName><Name>FingerprintInfoProvider</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>32768</Size><Status>1</Status></App><App><PackageName>com.android.dreams.phototable</PackageName><Name>照片屏幕保护程序</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>262144</Size><Status>1</Status></App><App><PackageName>com.qiku.gamecenter</PackageName><Name>游戏中心</Name><VersionName>1.0.23</VersionName><VersionCode>10231</VersionCode><Type>1</Type><Size>9748480</Size><Status>1</Status></App><App><PackageName>com.yulong.floatwindow</PackageName><Name>FloatWindow</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>73728</Size><Status>1</Status></App><App><PackageName>com.qiku.android.setupwizard</PackageName><Name>开机引导</Name><VersionName>1.01.001.151118_VER_2015.11.18_20:26:55</VersionName><VersionCode>101001</VersionCode><Type>1</Type><Size>1409024</Size><Status>1</Status></App><App><PackageName>com.android.smspush</PackageName><Name>com.android.smspush</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>114688</Size><Status>1</Status></App><App><PackageName>com.yulong.android.signalanalyse</PackageName><Name>信号显示工具</Name><VersionName>2.0.2_VER_2015.10.13_15:40:49</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>1585152</Size><Status>1</Status></App><App><PackageName>com.android.wallpaper.livepicker</PackageName><Name>Live Wallpaper Picker</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>61440</Size><Status>1</Status></App><App><PackageName>com.yulong.android.videoplayer</PackageName><Name>视频</Name><VersionName>V3.0.05_VER_2015.11.21_16:06:20</VersionName><VersionCode>7</VersionCode><Type>1</Type><Size>15532032</Size><Status>1</Status></App><App><PackageName>com.coolpad.music</PackageName><Name>酷我音乐</Name><VersionName>6.8.9.9</VersionName><VersionCode>6899</VersionCode><Type>1</Type><Size>47468544</Size><Status>1</Status></App><App><PackageName>com.android.settings</PackageName><Name>设置</Name><VersionName>_VER_2015.11.25_16:36:21</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>13815808</Size><Status>1</Status></App><App><PackageName>com.youku.phone.qiku</PackageName><Name>优酷视频</Name><VersionName>4.7.5</VersionName><VersionCode>75</VersionCode><Type>1</Type><Size>67747840</Size><Status>1</Status></App><App><PackageName>com.yulong.android.cp_engmode</PackageName><Name>工程模式</Name><VersionName>2.01.816_VER_2015.11.09_15:09:35</VersionName><VersionCode>201816</VersionCode><Type>1</Type><Size>614400</Size><Status>1</Status></App><App><PackageName>com.android.calculator2</PackageName><Name>计算器</Name><VersionName>1.01.001_VER_2015.11.20_14:34:33</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>10129408</Size><Status>1</Status></App><App><PackageName>com.qualcomm.location</PackageName><Name>LocationServices</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>3457024</Size><Status>1</Status></App><App><PackageName>com.qiku.onekeylock</PackageName><Name>一键锁屏</Name><VersionName>1.0_VER_2015.10.31_12:21:36</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>20480</Size><Status>1</Status></App><App><PackageName>com.qiku.android.configcenter</PackageName><Name>com.qiku.android.configcenter</Name><VersionName>1.0.0_VER_2015.11.25_20:42:49</VersionName><VersionCode>100</VersionCode><Type>1</Type><Size>589824</Size><Status>1</Status></App><App><PackageName>com.android.wallpaper</PackageName><Name>Android动态壁纸</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>65536</Size><Status>1</Status></App><App><PackageName>com.yulong.android.userreport</PackageName><Name>用户反馈</Name><VersionName>3.6.1_VER_2015.12.03_14:06:36</VersionName><VersionCode>20150922</VersionCode><Type>1</Type><Size>11620352</Size><Status>1</Status></App><App><PackageName>com.android.vpndialogs</PackageName><Name>VpnDialogs</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>28672</Size><Status>1</Status></App><App><PackageName>com.android.settings.wifi</PackageName><Name>Wi-Fi</Name><VersionName>_VER_2015.11.30_17:00:46</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>2289664</Size><Status>1</Status></App><App><PackageName>com.android.phone</PackageName><Name>电话</Name><VersionName>_VER_2015.11.25_18:03:34</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>10866688</Size><Status>1</Status></App><App><PackageName>com.android.shell</PackageName><Name>Shell</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>741376</Size><Status>1</Status></App><App><PackageName>com.android.usbui</PackageName><Name>USB用户界面</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>131072</Size><Status>1</Status></App><App><PackageName>com.android.providers.userdictionary</PackageName><Name>User Dictionary</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>49152</Size><Status>1</Status></App><App><PackageName>com.android.location.fused</PackageName><Name>一体化位置信息</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>40960</Size><Status>1</Status></App><App><PackageName>com.yulong.runintest</PackageName><Name>老化测试</Name><VersionName>1.0_VER_2015.09.30_19:46:02</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>557056</Size><Status>1</Status></App><App><PackageName>com.android.systemui</PackageName><Name>系统界面</Name><VersionName>_VER_2015.12.01_17:39:19</VersionName><VersionCode>15</VersionCode><Type>1</Type><Size>9281536</Size><Status>1</Status></App><App><PackageName>com.amap.android.location</PackageName><Name>网络位置</Name><VersionName>3.5.8</VersionName><VersionCode>358</VersionCode><Type>1</Type><Size>1073152</Size><Status>1</Status></App><App><PackageName>com.yulong.android.delcom</PackageName><Name>漫游上网</Name><VersionName>1.0.6</VersionName><VersionCode>10</VersionCode><Type>1</Type><Size>20017152</Size><Status>1</Status></App><App><PackageName>com.yulong.android.diagfw</PackageName><Name>DiagFramework</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>102400</Size><Status>1</Status></App><App><PackageName>com.android.settings.bluetooth</PackageName><Name>蓝牙</Name><VersionName>_VER_2015.11.03_15:32:07</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>4698112</Size><Status>1</Status></App><App><PackageName>com.yulong.android.gpsview</PackageName><Name>GPSView</Name><VersionName>3.0.16_VER_2015.10.12_17:28:25</VersionName><VersionCode>4</VersionCode><Type>1</Type><Size>868352</Size><Status>1</Status></App><App><PackageName>com.qiku.freecall</PackageName><Name>免费电话</Name><VersionName>1.0_VER_2015.11.17_19:15:40</VersionName><VersionCode>2</VersionCode><Type>1</Type><Size>11956224</Size><Status>1</Status></App><App><PackageName>com.yulong.android.soundrecorder</PackageName><Name>录音</Name><VersionName>1.00.020_VER_2015.11.02_16:59:39</VersionName><VersionCode>100020</VersionCode><Type>1</Type><Size>6402048</Size><Status>1</Status></App><App><PackageName>com.android.bluetooth</PackageName><Name>蓝牙共享</Name><VersionName>_VER_2015.12.01_11:43:43</VersionName><VersionCode>0</VersionCode><Type>1</Type><Size>4534272</Size><Status>1</Status></App><App><PackageName>com.qualcomm.timeservice</PackageName><Name>com.qualcomm.timeservice</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>28672</Size><Status>1</Status></App><App><PackageName>com.android.providers.contacts</PackageName><Name>联系人存储</Name><VersionName>5.01.001_VER_2015.10.22_17:03:21</VersionName><VersionCode>141202</VersionCode><Type>1</Type><Size>7974912</Size><Status>1</Status></App><App><PackageName>com.android.captiveportallogin</PackageName><Name>CaptivePortalLogin</Name><VersionName>5.1.1-5.1.094.P2.151208.8692</VersionName><VersionCode>22</VersionCode><Type>1</Type><Size>36864</Size><Status>1</Status></App><App><PackageName>com.qiku.bbs</PackageName><Name>奇酷社区</Name><VersionName>2.1.0_VER_2015.11.30_09:28:33</VersionName><VersionCode>20151120</VersionCode><Type>1</Type><Size>16281600</Size><Status>1</Status></App><App><PackageName>com.yulong.android.preset</PackageName><Name>DiagFramework</Name><VersionName>1.0</VersionName><VersionCode>1</VersionCode><Type>1</Type><Size>28672</Size><Status>1</Status></App></AppList></Request>'
        #1001  0  0  300  应用推送
        ##1001  0  0  1   客户端激活
        protocolFlg = 1001
        compressFlg = 0
        encryptFlg = 0
        commandFlg = 300
        httplib.HTTPConnection.debuglevel = 1

        myreq=url_request()
        if portNumber.strip() == '':
            conn = httplib.HTTPConnection(serverIp)
        else:
            conn = httplib.HTTPConnection(serverIp, portNumber)
        data = "%s%s%s%s" % (struct.pack("<i", protocolFlg), struct.pack("<i", compressFlg), struct.pack("<i", encryptFlg),
                             struct.pack("<i", commandFlg))
        data = '%s%s%s' % (str(data), str(struct.pack("<i", len(content))), str(content))
        headers = {}
        conn.request("POST", requestAddress, data, headers)
        res = conn.getresponse()
        content = str(res.read())
        print content
        result = content.find('</Result>')
        if result == -1:
            myreq.error.append("请求失败")
            return 'false'
        else:
            myreq.result.append(str(content[result - 1]))  #将result结果放到列表中

    #用于计算每个请求的响应时间
    def requestTime(self):
        myreq=url_request()
        beforeTime = datetime.datetime.now()
        myreq.testProtocol()
        afterTime = datetime.datetime.now()

        ResponseTime=float((afterTime-beforeTime).microseconds)/1000 #获取响应时间，单位ms
        myreq.times.append(ResponseTime) #将响应时间写入数组


if __name__=='__main__':
    myreq=url_request()
    threads = []
    starttime = datetime.datetime.now()
    print "request start time %s" %starttime
    nub = 1 #设置并发线程数
    # ThinkTime = 0.5#设置思考时间
    for i in range(1,nub+1):
        t = threading.Thread(target=myreq.requestTime)
        threads.append(t)
    for t in threads:
        # time.sleep(ThinkTime)
        # print "thread %s" %t #打印线程
        t.setDaemon(True)
        t.start()
    for t in threads:
        t.join()
    endtime = datetime.datetime.now()
    print "request end time %s" %endtime

    time.sleep(3)
    AverageTime = "{:.3f}".format(float(sum(myreq.times))/float(len(myreq.times))) #计算数组的平均值，保留3位小数
    print "Average Response Time %s ms" %AverageTime #打印平均响应时间
    usetime = str(endtime - starttime)
    hour = usetime.split(':').pop(0)
    minute = usetime.split(':').pop(1)
    second = usetime.split(':').pop(2)
    totaltime = float(hour)*60*60 + float(minute)*60 + float(second) #计算总的思考时间+请求时间

    print "Concurrent processing %s" %nub #打印并发数
    print "use total time %s s" %(totaltime) #打印总共消耗的时间-float(nub*ThinkTime)
    print "fail request %s" %myreq.error.count("请求失败") #打印错误请求数
    print "result reponse value %s" % myreq.result.count("0")
